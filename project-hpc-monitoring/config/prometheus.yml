# Prometheus configuration for HPC GPU cluster monitoring
# Scrapes GPU metrics from DCGM Exporter and custom NCCL metrics exporter

global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  # DCGM Exporter - GPU hardware metrics (utilization, memory, temp)
  - job_name: "dcgm-exporter"
    static_configs:
      - targets: ["dcgm-exporter:9400"]
        labels:
          cluster: "hpc-dev"

  # Custom GPU exporter (fallback when DCGM is unavailable)
  - job_name: "gpu-exporter"
    static_configs:
      - targets: ["gpu-exporter:9090"]
        labels:
          cluster: "hpc-dev"

  # NCCL profiling metrics exporter
  - job_name: "nccl-metrics"
    static_configs:
      - targets: ["nccl-exporter:9091"]
        labels:
          cluster: "hpc-dev"

  # Kubernetes node metrics (CPU, RAM, disk)
  - job_name: "node-exporter"
    static_configs:
      - targets: ["node-exporter:9100"]

  # Prometheus self-monitoring
  - job_name: "prometheus"
    static_configs:
      - targets: ["localhost:9090"]
